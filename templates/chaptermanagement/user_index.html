{%extends "base.html" %}
{% block content %}
<div class = "container">
<div class = "row">
	<table class = "table table-striped table-bordered">
		<thead>
			<tr>
				<th>First Name</th>
        <th>Last Name</th>
        <th>User Name</th>
			</tr>
		</thead>
		<tbody>
			{% for user in all_users %}
			<tr>
				<td>{{user.first_name}}</td>
				<td>{{user.last_name}}</td>
        <td>{{user.username}}</td>
			</tr>
			{% endfor %}
		</tbody>
	</table>
</div>
<!-- Button trigger modal -->
<button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#myModal">
  Add New Brother
</button>
</div>
    {% load crispy_forms_tags %}


<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">Modal title</h4>
      </div>
      <div class="modal-body">
      	    {% crispy SingleUserCreationForm %}
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        <button type="submit" form = "form1" class="btn btn-primary">Save changes</button>
      </div>
    </div>
  </div>
</div>



<script>
$(document).ready(function(){
  var form = $('form');
  form.on('submit', function(e) {
    // prevent default action
    e.preventDefault();
    // send ajax request
    $.ajax({
      url: '/authentication/createSingleUser',
      type: 'POST',
      cache: false,
      data: form.serialize(), //form serizlize data
      success: function(data){
        // Append with fadeIn see http://stackoverflow.com/a/978731
        var item = $('<tr><td class="span2">' + data.first_name + '</td><td>' + data.last_name + '</td></tr>').hide()
        $('table > tbody:last').append(item);
        item.fadeIn("slow");
        $('#myModal').modal('hide');
      },
      error: function(e){
        alert(e);
      }
    });
  });
});
</script>
{% endblock %}